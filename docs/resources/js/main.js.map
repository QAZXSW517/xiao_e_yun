{"version":3,"sources":["webpack://test/./ts/main.ts","webpack://test/./ts/core/index.ts"],"names":["document","addEventListener","image_file","info","background","low_quality_url","high_quality_url","this","console","log","img","Image","pre_background","getElementById","main_background","start_time","Date","now","image_load","el","url","done","src","style","backgroundImage","once","done_time","remove","fade_out","time","opacity","getComputedStyle","total_i","Math","floor","i","interval","setInterval","run","clearInterval"],"mappings":"mBACAA,SAASC,iBAAiB,oBAAoB,KAC1C,MACMC,EAAa,+BADN,ICFjB,MACI,cAwDO,KAAAC,KAAO,SAtDPC,WAAWC,EAAwBC,GACtC,MAAMH,EAAOI,KAAKJ,KAAK,SACvBK,QAAQC,IAAIN,EAAK,QACjB,MAAMO,EAAM,IAAIC,MACVC,EAAiBZ,SAASa,eAAe,sBACzCC,EAAkBd,SAASa,eAAe,mBAE1CE,EAAaC,KAAKC,MAcxB,SAASC,EAAWC,EAAeC,EAAWC,GAC1CX,EAAIY,IAAMjB,EACVK,EAAIT,iBAAiB,QAAQ,KACzBoB,IACAF,EAAGI,MAAMC,gBAAkB,OAAOJ,OACpC,CAACK,MAAK,IAlBZP,EAAWN,EAAeP,GAAgB,KACtCG,QAAQC,IAAIN,EAAK,aACjBe,EAAWJ,EAAgBR,GAAiB,KACxC,MAAMoB,EAAYV,KAAKC,MACvBT,QAAQC,IAAIN,EAAK,aACbuB,EAAYX,GAAc,GAC1BH,EAAee,SAEfpB,KAAKqB,SAAShB,GAAe,KAAKA,EAAee,WAAU,YAcpEC,SAAST,EAAeE,EAAcQ,EAAY,KACrD,MAAM1B,EAAOI,KAAKJ,KAAK,MACvBK,QAAQC,IAAIN,EAAK0B,EAAK,MAEtB,MAAMC,EAAUC,iBAAiBZ,GAAIW,QAG/BE,EAAUC,KAAKC,MAAML,EADV,IAEjB,IAAIM,EAAIH,EAER,MAAMI,EAAWC,YAAYC,EAJZ,IAOjB,SAASA,IACJnB,EAAGI,MAAMO,QAAgCA,EAAUE,EAAUG,EAE9DA,IACS,IAANA,IACCI,cAAcH,GACdf,KARRiB,ODxCClC,WAAW,GAAGF,cAAuB,GAAGA,YAC/C,CAACuB,MAAK,K","file":"../resources/js/main.js","sourcesContent":["import main_core from './core'\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    const main = new main_core()\r\n    const image_file = \"resources/images/background\"\r\n    main.background(`${image_file}_blur.webp`,`${image_file}.webp`)\r\n},{once:true})","export  default class{\r\n    public constructor(){\r\n    }\r\n    public background(low_quality_url:string, high_quality_url:string){\r\n        const info = this.info+\"背景加載器|\"\r\n        console.log(info+\"開始運行\")\r\n        const img = new Image()\r\n        const pre_background = document.getElementById('preload_background')\r\n        const main_background = document.getElementById('main_background')\r\n\r\n        const start_time = Date.now()\r\n        image_load(pre_background,low_quality_url,()=>{\r\n            console.log(info+\"加載成功低畫質背景\")\r\n            image_load(main_background,high_quality_url,()=>{\r\n                const done_time = Date.now()\r\n                console.log(info+\"加載成功高畫質背景\")\r\n                if((done_time - start_time)<= 50){\r\n                    pre_background.remove()\r\n                }else{\r\n                    this.fade_out(pre_background,()=>{pre_background.remove()},1200)\r\n                }\r\n            })\r\n        })\r\n        \r\n        function image_load(el:HTMLElement,url:string,done:()=>void) {\r\n            img.src = low_quality_url\r\n            img.addEventListener('load', () => {\r\n                done()\r\n                el.style.backgroundImage = `url(${url})`\r\n            },{once:true})\r\n        }\r\n    }\r\n\r\n    public fade_out(el:HTMLElement,done:()=>void,time:number=400){\r\n        const info = this.info+\"淡出|\"\r\n        console.log(info+time+\"ms\")\r\n\r\n        const opacity = getComputedStyle(el).opacity as unknown as number\r\n\r\n        const run_time = 10 //間隔 100ms\r\n        const total_i = Math.floor(time / run_time) //總運行次數\r\n        let i = total_i //運行次數\r\n\r\n        const interval = setInterval(run,run_time)\r\n        run()\r\n\r\n        function run() { \r\n            (el.style.opacity as unknown as number) = opacity / total_i * i\r\n            \r\n            i--\r\n            if(i === 0){\r\n                clearInterval(interval)\r\n                done()\r\n            }\r\n        }\r\n    }\r\n\r\n    public info = \"|主要核心|\"\r\n}"],"sourceRoot":""}